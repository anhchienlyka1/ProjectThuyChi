<div class="profile-container">
  <!-- Sky Blue Background with Clouds -->
  <div class="sky-background"></div>

  <!-- Animated Clouds -->
  <div class="clouds">
    <div class="cloud cloud-1"></div>
    <div class="cloud cloud-2"></div>
    <div class="cloud cloud-3"></div>
    <div class="cloud cloud-4"></div>
  </div>

  <!-- Floating Elements -->
  <div class="floating-elements">
    <span class="float-icon icon-1">â­</span>
    <span class="float-icon icon-2">ğŸ“š</span>
    <span class="float-icon icon-3">ğŸ¨</span>
    <span class="float-icon icon-4">ğŸµ</span>
    <span class="float-icon icon-5">ğŸŒˆ</span>
    <span class="float-icon icon-6">ğŸ¦‹</span>
    <span class="float-icon icon-7">ğŸ†</span>
    <span class="float-icon icon-8">ğŸ’</span>
  </div>

  <!-- Main Content -->
  <div class="content-wrapper">
    <!-- Loading State -->
    @if (isLoading()) {
    <div class="loading-state">
      <div class="loading-spinner"></div>
      <p class="loading-text">Äang táº£i há»“ sÆ¡ cá»§a bÃ©...</p>
    </div>
    } @else {

    <!-- Header Row (Back Button + Title) -->
    <div class="header-row">
      <div class="header-left">
        <kid-button (click)="goBack()" variant="neutral" size="md">
          â† Quay láº¡i
        </kid-button>
      </div>

      <div class="header-center">
        <h1 class="page-title-inline">Há»“ SÆ¡ Cá»§a BÃ©</h1>
        <div class="title-decoration-inline">
          <span class="decoration-star-small">âœ¨</span>
          <span class="decoration-star-small">âœ¨</span>
        </div>
      </div>

      <div class="header-right"></div> <!-- Spacer for balancing center alignment -->
    </div>

    <!-- Profile Card - Premium Glassmorphism -->
    <div class="profile-card-premium">
      <div class="profile-card-glow"></div>
      <div class="profile-card-content">
        <!-- Avatar Section -->
        <div class="avatar-section">
          <div class="avatar-glow-ring"></div>
          <kid-avatar [src]="gameStore.profile().avatar" [size]="140" borderColor="primary"
            status="online"></kid-avatar>
        </div>

        <!-- Info Section -->
        <div class="info-section">
          <h2 class="student-name">{{ gameStore.profile().name }}</h2>

          <!-- Badges -->
          <div class="badges-row">
            <div class="badge badge-level">
              <span class="badge-icon">ğŸ…</span>
              <span class="badge-text">Level {{ gameStore.profile().level }}</span>
            </div>
            <div class="badge badge-stars">
              <span class="badge-icon">ğŸŒŸ</span>
              <span class="badge-text">{{ gameStore.stars() }} Sao</span>
            </div>
          </div>

          <!-- Progress Section -->
          <div class="progress-section">
            <div class="progress-header">
              <span class="progress-label">Tiáº¿n Ä‘á»™ Level tiáº¿p theo</span>
              <span class="progress-value">{{ gameStore.profile().currentXp }} / {{ gameStore.profile().nextLevelXp }}
                XP</span>
            </div>
            <kid-progress-bar [value]="gameStore.progressPercent()" color="primary" [height]="24"></kid-progress-bar>
          </div>
        </div>
      </div>
    </div>

    <!-- Stats Grid - Premium Cards -->
    <div class="stats-grid-premium">
      <!-- Lessons Card -->
      <div class="stat-card stat-card-cyan">
        <div class="stat-card-inner">
          <div class="stat-icon-wrapper">
            <div class="stat-icon">ğŸ“š</div>
          </div>
          <div class="stat-label">BÃ i Há»c HÃ´m Nay</div>
          <div class="stat-value">{{ todayStats().lessons }}</div>
        </div>
      </div>

      <!-- Correct Answers Card -->
      <div class="stat-card stat-card-yellow">
        <div class="stat-card-inner">
          <div class="stat-icon-wrapper">
            <div class="stat-icon">âœ…</div>
          </div>
          <div class="stat-label">CÃ¢u Tráº£ Lá»i ÄÃºng</div>
          <div class="stat-value">{{ todayStats().correct }}</div>
        </div>
      </div>

      <!-- Study Time Card -->
      <div class="stat-card stat-card-pink">
        <div class="stat-card-inner">
          <div class="stat-icon-wrapper">
            <div class="stat-icon">â±ï¸</div>
          </div>
          <div class="stat-label">PhÃºt Há»c Táº­p</div>
          <div class="stat-value">{{ todayStats().durationMinutes }}</div>
        </div>
      </div>
    </div>

    <!-- Achievements Section -->
    <div class="achievements-section">
      <div class="section-header">
        <h2 class="section-title">
          <span class="section-icon">ğŸµï¸</span>
          Phiáº¿u BÃ© Ngoan
        </h2>
        <kid-button (click)="viewAllCertificates()" variant="secondary" size="md">
          ğŸ“œ Xem táº¥t cáº£ phiáº¿u
        </kid-button>
      </div>

      <!-- Certificates Grid -->
      <div class="certificates-grid">
        @for (cert of recentCertificates(); track cert.id) {
        <div (click)="viewAllCertificates()" class="certificate-card-premium"
          [class.certificate-locked]="!cert.unlocked">
          <div class="certificate-glow"></div>
          <div class="certificate-content" [ngClass]="{
            'certificate-pink': cert.theme === 'pink' && cert.unlocked,
            'certificate-blue': cert.theme === 'blue' && cert.unlocked,
            'certificate-yellow': cert.theme === 'yellow' && cert.unlocked,
            'certificate-green': cert.theme === 'green' && cert.unlocked
          }">
            <!-- Icon -->
            <div class="certificate-icon-premium">
              @if (cert.unlocked) { ğŸµï¸ } @else { ğŸ”’ }
            </div>

            <!-- Content -->
            <div class="certificate-info">
              <h3 class="certificate-name" [ngClass]="{
                'text-pink-600': cert.theme === 'pink' && cert.unlocked,
                'text-blue-600': cert.theme === 'blue' && cert.unlocked,
                'text-yellow-600': cert.theme === 'yellow' && cert.unlocked,
                'text-green-600': cert.theme === 'green' && cert.unlocked,
                'text-gray-500': !cert.unlocked
              }">{{ cert.name }}</h3>
              <p class="certificate-desc">{{ cert.description }}</p>
              @if (cert.date && cert.unlocked) {
              <div class="certificate-date-badge">
                <span>ğŸ“…</span>
                <span>{{ cert.date }}</span>
              </div>
              }
            </div>

            <!-- Arrow -->
            <div class="certificate-arrow-icon">âœ</div>
          </div>

          <!-- Locked Overlay -->
          @if (!cert.unlocked) {
          <div class="certificate-locked-overlay">
            <span class="locked-badge">ğŸ”’ ChÆ°a Ä‘áº¡t Ä‘Æ°á»£c</span>
          </div>
          }
        </div>
        }
      </div>
    </div>
    }
  </div>
</div>