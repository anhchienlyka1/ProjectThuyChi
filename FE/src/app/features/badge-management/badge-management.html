<div class="min-h-screen relative pb-20 bg-gradient-to-br from-purple-100 via-pink-100 to-blue-100">
    <!-- Decorative Floating Icons -->
    <div class="floating-decorations">
        <div class="floating-icon icon-1">üèÜ</div>
        <div class="floating-icon icon-2">‚≠ê</div>
        <div class="floating-icon icon-3">üéñÔ∏è</div>
        <div class="floating-icon icon-4">üëë</div>
        <div class="floating-icon icon-5">üíé</div>
        <div class="floating-icon icon-6">üåü</div>
        <div class="floating-icon icon-7">üí´</div>
        <div class="floating-icon icon-8">‚ú®</div>
    </div>

    <!-- Main Content -->
    <div class="container mx-auto max-w-6xl px-4 space-y-8 pt-6">
        <!-- Header -->
        <div class="flex items-center justify-between mb-6">
            <kid-button (click)="goBack()" variant="neutral" size="md">
                ‚Üê Quay l·∫°i
            </kid-button>
            <kid-button (click)="openAddModal()" variant="primary" size="lg">
                ‚ûï Th√™m Phi·∫øu B√© Ngoan M·ªõi
            </kid-button>
        </div>

        <!-- Title -->
        <div class="text-center relative z-10">
            <h1
                class="text-4xl md:text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600 drop-shadow-sm tracking-wide inline-block">
                üèÜ Qu·∫£n L√Ω Phi·∫øu B√© Ngoan
            </h1>
            <p class="text-gray-600 mt-2 text-lg font-semibold">T·∫°o v√† qu·∫£n l√Ω c√°c phi·∫øu b√© ngoan cho b√©</p>
        </div>

        <!-- Badges Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-8">
            @for (badge of achievementService.badges(); track badge.id) {
            <kid-card borderColor="primary">
                <div class="relative p-6">
                    <!-- Badge Content -->
                    <div class="text-center space-y-4">
                        <div class="text-7xl animate-wiggle">{{ badge.icon }}</div>
                        <div>
                            <h3 class="text-2xl font-black text-gray-800">{{ badge.name }}</h3>
                            <p class="text-sm text-gray-600 mt-2">{{ badge.description }}</p>
                        </div>

                        <!-- Status Badge -->
                        <div class="flex justify-center">
                            @if (badge.unlocked) {
                            <span
                                class="bg-green-100 text-green-700 px-4 py-2 rounded-full font-bold text-sm border-2 border-green-300">
                                ‚úÖ ƒê√£ M·ªü Kh√≥a
                            </span>
                            } @else {
                            <span
                                class="bg-gray-100 text-gray-600 px-4 py-2 rounded-full font-bold text-sm border-2 border-gray-300">
                                üîí Ch∆∞a M·ªü Kh√≥a
                            </span>
                            }
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex gap-3 mt-6">
                        <kid-button (click)="openEditModal(badge)" variant="secondary" size="md" class="flex-1">
                            ‚úèÔ∏è S·ª≠a
                        </kid-button>
                        <kid-button (click)="deleteBadge(badge.id)" variant="danger" size="md" class="flex-1">
                            üóëÔ∏è X√≥a
                        </kid-button>
                    </div>
                </div>
            </kid-card>
            }
        </div>

        <!-- Empty State -->
        @if (achievementService.badges().length === 0) {
        <div class="text-center py-20">
            <div class="text-8xl mb-4">üéØ</div>
            <h3 class="text-2xl font-black text-gray-600 mb-2">Ch∆∞a c√≥ phi·∫øu b√© ngoan n√†o</h3>
            <p class="text-gray-500 mb-6">H√£y t·∫°o phi·∫øu b√© ngoan ƒë·∫ßu ti√™n c·ªßa b·∫°n!</p>
            <kid-button (click)="openAddModal()" variant="primary" size="lg">
                ‚ûï Th√™m Phi·∫øu B√© Ngoan ƒê·∫ßu Ti√™n
            </kid-button>
        </div>
        }
    </div>

    <!-- Modal -->
    @if (showModal()) {
    <div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 backdrop-blur-sm"
        (click)="closeModal()">
        <div class="bg-white rounded-3xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto border-4 border-purple-300"
            (click)="$event.stopPropagation()">
            <!-- Modal Header -->
            <div class="bg-gradient-to-r from-purple-500 to-pink-500 p-6 rounded-t-3xl">
                <h2 class="text-3xl font-black text-white text-center">
                    {{ editingBadge() ? '‚úèÔ∏è Ch·ªânh S·ª≠a Phi·∫øu B√© Ngoan' : '‚ûï Th√™m Phi·∫øu B√© Ngoan M·ªõi' }}
                </h2>
            </div>

            <!-- Modal Body -->
            <div class="p-8 space-y-6">
                <!-- Icon Selection -->
                <div>
                    <label class="block text-lg font-black text-gray-700 mb-3">Ch·ªçn Bi·ªÉu T∆∞·ª£ng</label>
                    <div class="grid grid-cols-8 gap-3">
                        @for (icon of availableIcons; track icon) {
                        <button type="button"
                            class="text-4xl p-3 rounded-2xl border-4 transition-all hover:scale-110 hover:shadow-lg"
                            [class.border-purple-500]="formData().icon === icon"
                            [class.bg-purple-100]="formData().icon === icon"
                            [class.border-gray-200]="formData().icon !== icon"
                            [class.bg-white]="formData().icon !== icon" (click)="selectIcon(icon)">
                            {{ icon }}
                        </button>
                        }
                    </div>
                </div>

                <!-- Name Input -->
                <div>
                    <label class="block text-lg font-black text-gray-700 mb-2">T√™n Phi·∫øu B√© Ngoan</label>
                    <input type="text" [(ngModel)]="formData().name"
                        class="w-full px-4 py-3 rounded-2xl border-4 border-gray-200 focus:border-purple-500 focus:outline-none text-lg font-bold"
                        placeholder="V√≠ d·ª•: B√© ngoan chƒÉm ch·ªâ">
                </div>

                <!-- Description Input -->
                <div>
                    <label class="block text-lg font-black text-gray-700 mb-2">M√¥ T·∫£</label>
                    <textarea [(ngModel)]="formData().description" rows="3"
                        class="w-full px-4 py-3 rounded-2xl border-4 border-gray-200 focus:border-purple-500 focus:outline-none text-lg font-bold resize-none"
                        placeholder="V√≠ d·ª•: Ki·∫øm ƒë∆∞·ª£c 10 ng√¥i sao"></textarea>
                </div>

                <!-- Condition Type -->
                <div>
                    <label class="block text-lg font-black text-gray-700 mb-2">ƒêi·ªÅu Ki·ªán M·ªü Kh√≥a</label>
                    <select [(ngModel)]="formData().conditionType"
                        class="w-full px-4 py-3 rounded-2xl border-4 border-gray-200 focus:border-purple-500 focus:outline-none text-lg font-bold">
                        <option value="stars">S·ªë Ng√¥i Sao</option>
                        <option value="mathCompleted">B√†i To√°n Ho√†n Th√†nh</option>
                        <option value="level">C·∫•p ƒê·ªô</option>
                    </select>
                </div>

                <!-- Condition Value -->
                <div>
                    <label class="block text-lg font-black text-gray-700 mb-2">Gi√° Tr·ªã Y√™u C·∫ßu</label>
                    <input type="number" [(ngModel)]="formData().conditionValue" min="1"
                        class="w-full px-4 py-3 rounded-2xl border-4 border-gray-200 focus:border-purple-500 focus:outline-none text-lg font-bold"
                        placeholder="10">
                </div>

                <!-- Unlocked Status (for editing) -->
                @if (editingBadge()) {
                <div class="flex items-center gap-3">
                    <input type="checkbox" [(ngModel)]="formData().unlocked" id="unlocked"
                        class="w-6 h-6 rounded border-4 border-gray-300 text-purple-500 focus:ring-purple-500">
                    <label for="unlocked" class="text-lg font-black text-gray-700">ƒê√£ M·ªü Kh√≥a</label>
                </div>
                }
            </div>

            <!-- Modal Footer -->
            <div class="p-6 bg-gray-50 rounded-b-3xl flex gap-4">
                <kid-button (click)="closeModal()" variant="neutral" size="lg" class="flex-1">
                    ‚ùå H·ªßy
                </kid-button>
                <kid-button (click)="saveBadge()" variant="primary" size="lg" class="flex-1">
                    üíæ {{ editingBadge() ? 'C·∫≠p Nh·∫≠t' : 'Th√™m M·ªõi' }}
                </kid-button>
            </div>
        </div>
    </div>
    }
</div>